<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
                          http://www.springframework.org/schema/webflow/spring-webflow-1.0.xsd">

	<start-state idref="mainView"/>

	<view-state id="mainView" view="supplierEntryTraceability/main">
		<transition on="searchForm" to="searchFormView" />
		<transition on="emptyEntryList" to="emptyEntryListView" />	
	</view-state>

	<view-state id="searchFormView" view="supplierEntryTraceability/searchForm">
		<transition on="submit" to="searchSupplierEntryAct">
			<action bean="traceabilityFormAction" method="bindAndValidate"/>
			<action bean="requestParamsFormAction" method="bindAndValidate"/>
		</transition>
	</view-state>

	<view-state id="emptyEntryListView" view="supplierEntryTraceability/searchEntryResult">
	</view-state>

	<action-state id="searchSupplierEntryAct">
		<bean-action bean="traceabilityBusiness" method="searchSupplierEntry">
			<method-arguments>
				<argument expression="flowScope.traceability"/>
				<argument expression="flowScope.requestParams"/>
			</method-arguments>
			<method-result name="traceability" scope="flow"/>
		</bean-action>
		<transition to="searchEntryResultView"></transition>
	</action-state>

	<view-state id="searchEntryResultView" view="supplierEntryTraceability/searchEntryResult">
		<transition on="export" to="searchEntryExportView">
			<action bean="requestParamsFormAction" method="bindAndValidate"/>
		</transition>
		<transition on="productDet" to="productDetView">
			<action bean="requestParamsFormAction" method="bindAndValidate"/>
		</transition>
		<transition on="newSearch" to="searchEntryView" />	
	</view-state>

	<view-state id="productDetView" view="supplierEntryTraceability/productDet">
		<transition on="export" to="searchEntryExportView">
			<action bean="requestParamsFormAction" method="bindAndValidate"/>
		</transition>
	</view-state>

	<view-state id="searchEntryExportView" view="supplierEntryTraceability/searchEntryExport">
	</view-state>
						
	<!-- Display the success view. -->
	<end-state id="terminateEntry" view="terminateEntry" />

</flow>